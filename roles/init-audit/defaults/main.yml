---
# init-audit defaults
ops_audit_enabled: true
ops_audit_max_log_file: 50
ops_audit_num_logs: 5
ops_audit_max_log_file_action: rotate
ops_audit_space_left_action: syslog
ops_audit_admin_space_left_action: halt

ops_audit_rules:
  # 时间变更
  - -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change
  - -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change
  - -a always,exit -F arch=b64 -S clock_settime -k time-change
  - -a always,exit -F arch=b32 -S clock_settime -k time-change
  - -w /etc/localtime -p wa -k time-change

  # 用户/组变更
  - -w /etc/passwd -p wa -k identity
  - -w /etc/shadow -p wa -k identity
  - -w /etc/group -p wa -k identity
  - -w /etc/gshadow -p wa -k identity

  # 网络配置变更
  - -w /etc/hosts -p wa -k system-network
  - -w /etc/resolv.conf -p wa -k system-network
  - -w /etc/sysconfig/network -p wa -k system-network

  # 登录/登出事件
  - -w /var/log/lastlog -p wa -k logins
  - -w /var/log/wtmp -p wa -k logins
  - -w /var/log/btmp -p wa -k logins
  - -w /var/run/faillock -p wa -k logins

  # sudo 和权限提升
  - -w /etc/sudoers -p wa -k sudoers
  - -w /etc/sudoers.d/ -p wa -k sudoers

  # cron 变更
  - -w /etc/crontab -p wa -k cron
  - -w /etc/cron.d/ -p wa -k cron
  - -w /etc/cron.daily/ -p wa -k cron
  - -w /etc/cron.hourly/ -p wa -k cron
  - -w /etc/cron.weekly/ -p wa -k cron
  - -w /etc/cron.monthly/ -p wa -k cron
  - -w /var/spool/cron/ -p wa -k cron

  # SSH 配置变更
  - -w /etc/ssh/sshd_config -p wa -k sshd
  - -w /etc/ssh/sshd_config.d/ -p wa -k sshd

  # 内核模块
  - -a always,exit -F arch=b64 -S init_module -S finit_module -S delete_module -k modules
  - -a always,exit -F arch=b32 -S init_module -S finit_module -S delete_module -k modules
